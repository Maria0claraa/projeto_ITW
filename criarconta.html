<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="utf-8" />
    <title>Criar Conta</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/js/bootstrap.bundle.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* Estilos personalizados para o formulário */
        .container {
            max-width: 600px;
            margin-top: 50px;
            margin-bottom: 100px;
        }

        .form-label {
            font-weight: bold;
        }

        .error-message {
            display: none;
            color: red;
            font-size: 0.875em;
        }

        .form-control:focus {
            border-color: #495057;
            box-shadow: none;
        }

        .btn {
            width: 100%;
            padding: 10px;
        }

        .btn-dark {
            background-color: #333;
            border-color: #333;
        }

        .btn-secondary {
            background-color: #e8e7e6;
            border-color: #ddd;
        }

        .d-flex .btn {
            margin-left: 10px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            color: #888;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg" style="background-color: #e8e7e6;">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">
                <img src="paris-2024-logo-1.png" alt="Logo" height="50" class="d-inline-block align-text-top">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="index.html">
                            <i class="fa fa-home"></i> Home
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="paises.html">
                            <i class="fa fa-globe"></i> Países
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="torneios.html">
                            <i class="fa fa-trophy"></i> Torneios
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="mapa.html">
                            <i class="fa fa-map"></i> Mapa
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="agenda.html">
                            <i class="fa-solid fa-calendar-days"></i> Agenda
                        </a>
                    </li>
                </ul>
            </div>
    </nav>

    <div class="container">
        <h1 class="text-center">Criar Conta</h1>

        <!-- Formulário para criação de conta -->
        <form id="criarContaForm" onsubmit="criarConta(event)">
            <div class="mb-3">
                <label for="nome" class="form-label">Nome completo:</label>
                <input type="text" class="form-control" id="nome" placeholder="Insira o seu nome completo" required>
                <div class="error-message" id="nome-error"></div>
            </div>

            <div class="mb-3">
                <label for="telefone" class="form-label">Nº de telefone:</label>
                <input type="tel" class="form-control" id="telefone" placeholder="Insira o seu nº de telefone"
                    pattern="[0-9]{9}" maxlength="9" required>
                <div class="error-message" id="telefone-error"></div>
            </div>

            <div class="mb-3">
                <label for="e_mail" class="form-label">Email:</label>
                <input type="email" class="form-control" id="e_mail" placeholder="Insira o seu email" required>
                <div class="error-message" id="email-error"></div>
            </div>

            <div class="mb-3">
                <label for="pass_word" class="form-label">Password:</label>
                <input type="password" class="form-control" id="pass_word" placeholder="Crie uma password" required>
                <div class="error-message" id="password-error"></div>
            </div>

            <div class="mb-3">
                <label for="confirm-password" class="form-label">Confirmar Password:</label>
                <input type="password" class="form-control" id="confirm-password" placeholder="Confirme a password"
                    required>
                <div class="error-message" id="confirm-password-error"></div>
            </div>

            <div class="d-flex justify-content-end">
                <a href="index.html" type="button" class="btn btn-secondary">Voltar</a>
                <button type="submit" class="btn btn-dark">Criar Conta</button>
            </div>
        </form>

    </div>

    <div class="footer">
        <p>Olimpíadas Paris 2024 - Projeto realizado na Universidade de Aveiro</p>
    </div>

    <script>
        // Função para salvar os dados da conta no localStorage
        function criarConta(event) {
            event.preventDefault();

            const nome = document.getElementById('nome').value;
            const telefone = document.getElementById('telefone').value;
            const email = document.getElementById('e_mail').value;
            const password = document.getElementById('pass_word').value;
            const confirmPassword = document.getElementById('confirm-password').value;

            let valid = true;

            // Validação de nome
            if (nome.trim() === '') {
                document.getElementById('nome-error').textContent = 'Nome completo é obrigatório.';
                document.getElementById('nome-error').style.display = 'block';
                valid = false;
            } else {
                document.getElementById('nome-error').style.display = 'none';
            }

            // Validação de telefone
            const phoneRegex = /^[0-9]{9}$/;
            if (!phoneRegex.test(telefone)) {
                document.getElementById('telefone-error').textContent = 'Número de telefone inválido. Deve ter 9 dígitos.';
                document.getElementById('telefone-error').style.display = 'block';
                valid = false;
            } else {
                document.getElementById('telefone-error').style.display = 'none';
            }

            // Validação de email
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                document.getElementById('email-error').textContent = 'Email inválido.';
                document.getElementById('email-error').style.display = 'block';
                valid = false;
            } else {
                document.getElementById('email-error').style.display = 'none';
            }

            // Validação de senha
            const passwordRegex = /^(?=.*\d)(?=.*[!@#$%^&*])[A-Za-z\d!@#$%^&*]{6,}$/;
            if (!passwordRegex.test(password)) {
                document.getElementById('password-error').textContent = 'Senha inválida. A senha deve ter pelo menos 6 caracteres, 1 número e 1 caractere especial.';
                document.getElementById('password-error').style.display = 'block';
                valid = false;
            } else {
                document.getElementById('password-error').style.display = 'none';
            }

            // Validação de confirmação de senha
            if (password !== confirmPassword) {
                document.getElementById('confirm-password-error').textContent = 'As senhas não coincidem.';
                document.getElementById('confirm-password-error').style.display = 'block';
                valid = false;
            } else {
                document.getElementById('confirm-password-error').style.display = 'none';
            }

            // Se tudo estiver válido, salvar os dados e mensagem de sucesso
            if (valid) {
                const usuario = {
                    nome,
                    telefone,
                    email,
                    password
                };

                // Verificar se o email já está registrado
                const usuariosCadastrados = JSON.parse(localStorage.getItem('usuarios')) || [];
                const usuarioExistente = usuariosCadastrados.find(u => u.email === email);

                if (usuarioExistente) {
                    alert('Já existe uma conta com esse email.');
                    return;
                }

                // Adicionar o novo usuário à lista de usuários
                usuariosCadastrados.push(usuario);
                localStorage.setItem('usuarios', JSON.stringify(usuariosCadastrados));

                // Armazenar o usuário no sessionStorage
                sessionStorage.setItem('user', JSON.stringify(usuario));

                alert('Conta criada com sucesso!');
                window.location.href = "index.html";
            }
        }
    </script>

</body>

</html>